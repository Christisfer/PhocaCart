function phChangeAttributeType(e){var t=(e=void 0!==e?".phj"+e:"")+".phjProductAttribute";jQuery(e+".phjCleanAttribute").remove(),jQuery(t).each(function(){var t,a,e,i="",r="#phItemAttribute"+jQuery(this).data("attribute-id-name"),d="#phItemHiddenAttribute"+jQuery(this).data("attribute-id-name"),u="#phItemBoxAttribute"+jQuery(this).data("attribute-id-name"),s=jQuery(this).data("attribute-type"),n=jQuery(this).data("type-view"),h=jQuery(this).data("type-icon"),c=jQuery(this).data("required");3==s?i="phSelectBoxImage":2==s&&(i="phSelectBoxButton"),""!=i&&(t=d+" ."+i,a=jQuery(r).attr("name"),(e=jQuery('<input type="hidden" name="'+a+'">')).val(jQuery(r).val()),e.insertAfter(jQuery(r)),jQuery(d).css("display","block"),jQuery(u).css({display:"visible",position:"absolute",clip:"rect(0,0,0,0)"}),jQuery(u).addClass("phj"+n+" phjCleanAttribute"),jQuery(r+" option").each(function(){var e;""!=jQuery(this).val()&&(3==s?e=jQuery('<div class="'+i+" "+h+'" data-value="'+jQuery(this).val()+'" data-value-alias="'+jQuery(this).data("value-alias")+'" title="'+jQuery(this).text()+'"><img src="'+jQuery(this).data("image")+'" alt="'+jQuery(this).text()+'" /></div>'):2==s&&(e=jQuery('<div class="'+i+" "+h+'" style="background-color:'+jQuery(this).data("color")+'" data-value="'+jQuery(this).val()+'" data-value-alias="'+jQuery(this).data("value-alias")+'" title="'+jQuery(this).text()+'">&nbsp;</div>')),jQuery(this).is(":selected")&&e.addClass("on"),jQuery(d).append(e))}),jQuery(t).on("click",function(e){if(e.preventDefault(),jQuery(this).hasClass("on")){if(1==c)return e.preventDefault(),!1;jQuery(this).removeClass("on"),jQuery('input[name="'+a+'"]').val(""),jQuery(r).val("").change()}else jQuery(t).removeClass("on"),jQuery(this).addClass("on"),jQuery('input[name="'+a+'"]').val(jQuery(this).data("value")),jQuery(r).val(jQuery(this).data("value")).change()}))})}function phAjaxChangeAttributeData(e,t,a,i){var r=Joomla.getOptions("phParamsPC"),d=Joomla.getOptions("phVarsPC").urlCheckoutChangeData,u=[];u.id=e,u.id_item_price="#phItemPriceBox"+t+e,u.id_item_stock="#phItemStockBox"+t+e,u.id_item_id="#phItemIdBox"+t+e,u.id_item_name="V"+t+"P"+e,u.product_add_to_cart_item=".phProductAddToCart"+t+e,u.product_add_to_cart_item_icon=".phProductAddToCartIcon"+t+e,u.view=t,u.method_price=r.dynamicChangePrice,u.method_stock=r.dynamicChangeStock,u.method_id=r.dynamicChangeId,u.method_image=r.dynamicChangeImage,u.task="change",u.type="changedata",u.class="ItemQuick"==t||"Pos"==t||"Item"==t?"ph-item-data-box":"ph-category-data-box";i="id="+u.id+"&"+a+"&"+i+"&class="+u.class+"&typeview="+u.view;phDoRequestMethods(d,i,u)}function phSetAttributeUrl(d){var e=Joomla.getOptions("phParamsPC"),t=Joomla.getOptions("phVarsPC");if(1!=e.dynamicChangeUrlAttributes)return!1;if("item"!=t.view)return!1;var t=jQuery(location).attr("hash"),t=phReplaceAll("#","",t),u=jQuery.deparam(t),s="",n="",h="";jQuery(".phjProductAttribute").each(function(){""!=s&&(s+="&");var e=this.id,t=jQuery(this).data("alias"),a="",i="",r="#phItemHiddenAttribute"+jQuery(this).data("attribute-id-name");1==d?(void 0!==jQuery(this).find(":selected").data("value-alias")&&(a=jQuery(this).find(":selected").data("value-alias"),s=s+"a["+jQuery(this).data("alias")+"]="+a),void 0!==jQuery(this).find(":input:checked").data("value-alias")&&(jQuery.each(jQuery(this).find(":input:checked"),function(){""!=i&&(i+=","),i+=jQuery(this).data("value-alias")}),""!=i&&(s=s+"a["+jQuery(this).data("alias")+"]="+i))):(void 0!==u.a&&void 0!==t&&void 0!==u.a[t]?(s=s+"a["+jQuery(this).data("alias")+"]="+u.a[t],void 0===(t=u.a[t].split(","))&&0==t.length||(jQuery("#"+e+" option").removeAttr("selected"),jQuery(r+" div").removeClass("on"),jQuery("#"+e+" input").removeAttr("checked"),jQuery(t).each(function(){jQuery("#"+e+" option[data-value-alias='"+this+"']").attr("selected","selected"),jQuery(r+" div[data-value-alias='"+this+"']").addClass("on"),jQuery("#"+e+" input[data-value-alias='"+this+"']").attr("checked","checked")}))):(void 0!==jQuery(this).find(":selected").data("value-alias")&&(a=jQuery(this).find(":selected").data("value-alias"),s=s+"a["+jQuery(this).data("alias")+"]="+a),void 0!==jQuery(this).find(":input:checked").data("value-alias")&&(jQuery.each(jQuery(this).find(":input:checked"),function(){""!=i&&(i+=","),i+=jQuery(this).data("value-alias")}),""!=i&&(s=s+"a["+jQuery(this).data("alias")+"]="+i))),n=jQuery(this).data("type-view"),h=jQuery(this).data("product-id"))}),(0!=e.dynamicChangePrice||0!=e.dynamicChangeStock||0!=e.dynamicChangeId||0!=e.dynamicChangeImage&&1!=e.dynamicChangeImage)&&(t=".phjAddToCartV"+n+"P"+h,e=jQuery(t).find("select").serialize(),t=jQuery(t).find(":checkbox").serialize(),phAjaxChangeAttributeData(h,n,e,t)),s.lastIndexOf("&")==s.length-1&&(s=s.slice(0,-1)),(0==d&&""!=s||1==d)&&(s="#"+s,window.history.pushState({},"",s))}jQuery(document).ready(function(){phChangeAttributeType(),phSetAttributeUrl(0);var e="select.phjProductAttribute";jQuery(document).on("change",e,function(e){var t=Joomla.getOptions("phParamsPC");if(0==t.dynamicChangePrice&&0==t.dynamicChangeStock&&0==t.dynamicChangeId&&(0==t.dynamicChangeImage||1==t.dynamicChangeImage))return!1;var a=jQuery(this).data("type-view"),i=jQuery(this).data("product-id"),t=".phjAddToCartV"+a+"P"+i;phAjaxChangeAttributeData(i,a,jQuery(t).find("select").serialize(),jQuery(t).find(":checkbox").serialize()),phSetAttributeUrl(1)});jQuery(document).on("click",".ph-checkbox-attribute.phjProductAttribute",function(e){var t=Joomla.getOptions("phParamsPC");if(0==t.dynamicChangePrice&&0==t.dynamicChangeStock&&0==t.dynamicChangeId&&(0==t.dynamicChangeImage||1==t.dynamicChangeImage))return!1;if("LABEL"!==e.target.tagName.toUpperCase()&&("bs4"!=t.theme||"SPAN"!==e.target.tagName.toUpperCase()&&"IMG"!==e.target.tagName.toUpperCase())){var a=jQuery(this).data("product-id"),i=jQuery(this).data("type-view"),r=".phjAddToCartV"+i+"P"+a,d=jQuery(r).find("select").serialize(),t=jQuery(r).find(":checkbox").serialize(),r=(jQuery(this).data("required"),"#"+jQuery(this).attr("id")+" input:checked");if(0==jQuery(r).length)return jQuery(e.target).parent().addClass("active"),e.preventDefault(),!1;phAjaxChangeAttributeData(a,i,d,t),phSetAttributeUrl(1)}})});